<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Workstation</title>
    <link rel="stylesheet" href="index.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet">
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^1.15.0",
    "cors": "https://aistudiocdn.com/cors@^2.8.5",
    "@vercel/kv": "https://aistudiocdn.com/@vercel/kv@^3.0.0",
    "express": "https://aistudiocdn.com/express@^5.1.0"
  }
}
</script>
</head>
<body>
    <div id="app-container" class="hidden">
        <aside id="chat-panel">
            <header>
                <div class="header-main-row">
                    <h1 id="welcome-message">AI Assistant</h1>
                    <div id="session-controls">
                        <span id="testing-mode-indicator" class="hidden" title="Click to disable Testing Mode">üß™ Testing Mode</span>
                        <button id="save-button" title="Save current session state">Save</button>
                        <button id="load-button" title="Load a saved session">Load</button>
                        <button id="logout-button" title="Log out of your account">Logout</button>
                    </div>
                </div>
                <div id="storage-indicator">
                    <span class="storage-label">Storage</span>
                    <div class="storage-bar-outer">
                        <div id="storage-bar-inner"></div>
                    </div>
                    <span id="storage-text"></span>
                </div>
            </header>
            <main id="chat-history"></main>
            <footer>
                <div id="chat-input-container">
                    <textarea id="chat-input" placeholder="Ask the AI to do something..." rows="1"></textarea>
                    <button id="send-button" aria-label="Send Message">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                        </svg>
                    </button>
                </div>
            </footer>
        </aside>
        <main id="desktop">
            <div id="desktop-icons">
                <div class="icon" id="icon-docs" tabindex="0" aria-label="Document Writer">
                    <div class="icon-img">üìù</div>
                    <span>Documents</span>
                </div>
                <div class="icon" id="icon-browser" tabindex="0" aria-label="Web Browser">
                    <div class="icon-img">üåê</div>
                    <span>Browser</span>
                </div>
                <div class="icon" id="icon-doodle" tabindex="0" aria-label="Doodle Pad">
                    <div class="icon-img">üé®</div>
                    <span>Doodle Pad</span>
                </div>
                <div class="icon" id="icon-studio" tabindex="0" aria-label="Image Studio">
                    <div class="icon-img">üñºÔ∏è</div>
                    <span>Image Studio</span>
                </div>
                 <div class="icon" id="icon-explorer" tabindex="0" aria-label="File Explorer">
                    <div class="icon-img">üìÅ</div>
                    <span>File Explorer</span>
                </div>
            </div>
            <!-- AI application windows will be dynamically added here -->
            <div id="cursor"></div>
        </main>
    </div>

    <div id="auth-modal" class="modal-overlay" style="display: flex;">
        <div class="modal-content auth-modal-content">
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">Login</button>
                <button class="auth-tab" data-tab="signup">Sign Up</button>
            </div>
            <div class="modal-body auth-body">
                <!-- Login Form -->
                <form id="login-form" class="auth-form active">
                    <input type="text" id="login-username" placeholder="Username" required>
                    <input type="password" id="login-password" placeholder="Password" required>
                    <button type="submit">Login</button>
                    <p id="login-error" class="error-message"></p>
                    <p class="security-note">New? Switch to the "Sign Up" tab to create an account.</p>
                </form>
                <!-- Sign Up Form -->
                <form id="signup-form" class="auth-form">
                    <input type="text" id="signup-username" placeholder="Username" required>
                    <input type="password" id="signup-password" placeholder="Password" required>
                    <p class="password-requirements">Must be 8+ characters and include an uppercase, lowercase, and number.</p>
                    <p class="security-note">Note: This is a demo. Please do not use a personal password.</p>
                    <button type="submit">Sign Up</button>
                    <p id="signup-error" class="error-message"></p>
                </form>
            </div>
        </div>
    </div>

    <div id="load-session-modal" class="modal-overlay">
        <div class="modal-content">
            <header class="modal-header">
                <h2>Load Session</h2>
                <button id="close-modal-btn" class="close-btn">&times;</button>
            </header>
            <div class="modal-body">
                <p>Select a session to load. The current session will be replaced.</p>
                <ul id="saved-sessions-list">
                    <!-- Session items will be dynamically inserted here -->
                </ul>
            </div>
        </div>
    </div>

    <button id="debug-button" title="Open Debug Console">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 10.5h-5l-1-1h7zM10 16v-4M14 16v-4M18 8h-1a2 2 0 0 1-2-2V5a2 2 0 0 1-2-2h-4a2 2 0 0 1-2 2v1a2 2 0 0 1-2 2H5a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2z"></path></svg>
    </button>
    
    <div id="debug-console" class="app-window hidden" style="width: 300px; height: 150px; left: calc(50% - 150px); top: calc(50% - 75px); z-index: 9998; resize: both;">
        <header class="window-header">
            <span class="window-title">üêû Debug Console</span>
            <div class="window-controls">
                <button id="close-debug-console-btn" class="close-btn" title="Close Console">&times;</button>
            </div>
        </header>
        <div class="window-body">
            <div class="placeholder">
                check back later bozo
            </div>
        </div>
    </div>


    <script type="module" src="index.tsx"></script>
</body>
</html>